---
title: "Complete API Reference"
description: "Complete API documentation for @joyfill/components"
icon: "book"
---

# API Reference

Complete reference documentation for all classes, components, and functions in `@joyfill/components`.

## Table of Contents

- [JoyDoc Component](#joydoc)
- [JoyDocExporter Component](#joydocexporter)
- [PublicAPI Object](#publicapi)

---

## JoyDoc

Main form builder component for creating and editing JoyDoc forms.

**Kind**: React Component  
**Returns**: `JSX.Element` - The JoyDoc component

### Props

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| `doc` | `Object` |  | The JoyDoc document object containing form structure and data |
| `mode` | `string` | `'edit'` | Display mode: 'edit', 'view', or 'preview' |
| `view` | `string` | `'desktop'` | View type: 'desktop', 'mobile', or 'tablet' |
| `theme` | `Object` |  | Custom theme object for styling |
| `width` | `number` | `816` | Component width in pixels |
| `height` | `number` | `1056` | Component height in pixels |
| `initialPageId` | `string` |  | ID of the initially active page |
| `lazyload` | `boolean` | `false` | Enable lazy loading for performance |
| `features` | `Object` |  | Feature flags object |
| `features.formulas` | `boolean` | `false` | Enable formula support |
| `features.readableIds` | `boolean` | `false` | Use readable IDs instead of object IDs |
| `features.repeatingHeaderAndFooter` | `boolean` | `false` | Enable repeating headers/footers |
| `features.validateSchema` | `boolean` | `false` | Enable schema validation |
| `fieldOptions` | `Array` |  | Custom field options array |
| `fieldSettings` | `Object` |  | Custom settings for different targets (page, field, table column) |
| `identifiers` | `Object` |  | Identifier configuration |
| `onChange` | `function` |  | Callback fired when document changes |
| `onCaptureAsync` | `function` |  | Async callback for field capture |
| `onUploadAsync` | `function` |  | Async callback for file uploads |
| `onError` | `function` |  | Error handler callback |
| `onFocus` | `function` |  | Field focus handler |
| `onBlur` | `function` |  | Field blur handler |
| `validateSchema` | `boolean` | `false` | Enable schema validation |

### Example

```jsx
import { JoyDoc } from '@joyfill/components';

<JoyDoc
  doc={myDocument}
  mode="edit"
  view="desktop"
  onChange={(updatedDoc) => console.log('Document updated:', updatedDoc)}
  features={{
    validateSchema: true,
    readableIds: true
  }}
/>
```

---

## JoyDocExporter

PDF export component for rendering JoyDoc forms as PDF-ready layouts.

**Kind**: React Component  
**Returns**: `JSX.Element` - The JoyDocExporter component

### Props

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| `doc` | `Object` |  | The JoyDoc document to export |
| `theme` | `Object` |  | Custom theme object for styling |
| `license` | `string` |  | JWT license key for validation |
| `config` | `Object` |  | Export configuration |
| `config.page` | `Object` |  | Page configuration |
| `config.page.height` | `number` | `1056` | Page height in pixels |
| `config.page.width` | `number` | `816` | Page width in pixels |
| `config.page.padding` | `number` | `0` | Page padding in pixels |

### Example

```jsx
import { JoyDocExporter } from '@joyfill/components';

<JoyDocExporter
  doc={myDocument}
  config={{
    page: {
      height: 1056,
      width: 816,
      padding: 20
    }
  }}
/>
```

---

## PublicAPI

Default export object containing all public APIs of `@joyfill/components`.

**Kind**: Global namespace

### Properties

| Name | Type | Description |
| --- | --- | --- |
| `JoyDoc` | `Component` | Main form builder component |
| `JoyDocExporter` | `Component` | PDF export component |
| `applyLogic` | `function` | Conditional logic application function |
| `duplicate` | `function` | Document duplication function |
| `duplicatePage` | `function` | Page duplication function |
| `getDefaultPage` | `function` | Default page creation function |
| `getDefaultDocument` | `function` | Default document creation function |
| `getDefaultTemplate` | `function` | Default template creation function |
| `getDocumentFromTemplate` | `function` | Document from template creation function |
| `generateObjectId` | `function` | Object ID generation function |
| `validator` | `function` | Document validation function |
| `validateSchema` | `function` | Schema validation function |
| `fieldOptions` | `Array` | Default field options configuration |
| `fieldColumnTypes` | `Object` | Field table column types configuration |

---

## Functions

### duplicate(original, [defaults])

Creates a deep-cloned and properly formatted duplicate of a Template or Document.

Generates a new `_id`, updates the `identifier` based on type (`template_` or `doc_`),
resets timestamps, and merges in optional default overrides. 
Ensures all references to the original object are removed via deep clone.

**Returns**: `Object` - A new object representing the duplicated Template or Document with updated metadata.

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| `original` | `Object` |  | The original Template or Document object to duplicate |
| `[defaults]` | `Object` | `{}` | Optional default values to override or extend the duplicated object |

**Example**

```javascript
import { duplicate } from "@joyfill/components";

const template = {
  _id: "template_123",
  type: "template",
  identifier: "template_123",
  name: "Inspection Template",
  fields: []
};

const copy = duplicate(template, { name: "Inspection Template Copy" });

console.log(copy);
// Output:
// {
//   _id: "template_67890",
//   type: "template",
//   identifier: "template_67890",
//   name: "Inspection Template Copy",
//   fields: [],
//   createdOn: 1730068483105,
//   source: "template_123"
// }
```

---

### duplicatePage(doc, fileId, pageId, useReadableIds)

Duplicates a page within a document and generates corresponding changelog entries.

This function creates a copy of a specified page in a document and generates
changelog entries to track the duplication operation. It handles both primary
pages and view pages, as well as any associated fields that need to be created.

**Returns**: `Object` - An object containing the updated document and changelogs

| Param | Type | Description |
| --- | --- | --- |
| `doc` | `Object` | The document object containing the page to duplicate |
| `fileId` | `string` | The ID of the file containing the document |
| `pageId` | `string` | The ID of the page to duplicate |
| `useReadableIds` | `boolean` | Whether to use readable IDs for generated elements |

**Example**

```javascript
import { duplicatePage } from "@joyfill/components";

const result = duplicatePage(document, 'file123', 'page456', true);
console.log(result.doc); // Updated document
console.log(result.changelogs); // Array of changelog entries
```

---

### getDefaultPage([defaults])

Creates a default page object for JoyDoc documents.

**Returns**: `Object` - Default page object with _id, name, width, height, rowHeight, cols, fieldPositions, layout, presentation, and padding

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| `[defaults]` | `Object` | `{}` | Optional configuration to override default values |

**Example**

```javascript
import { getDefaultPage } from '@joyfill/components';

const page = getDefaultPage();
// Returns: { _id: "...", name: "New Page", width: 816, height: 1056, ... }

const customPage = getDefaultPage({
  name: "Custom Page",
  width: 1200,
  height: 1600
});
```

---

### getDefaultDocument()

Creates a new JoyDoc document with standard properties and structure.
The document will have a unique ID, proper type, and identifier.

**Returns**: `Object` - A properly formatted Document JoyDoc

**Example**

```javascript
import { getDefaultDocument } from '@joyfill/components';

const newDoc = getDefaultDocument();
console.log('Document ID:', newDoc._id);
console.log('Document type:', newDoc.type);
console.log('Document name:', newDoc.name);
```

---

### getDefaultTemplate()

Gets a default template structure for JoyDoc documents.
Creates a new template object that can be used to generate multiple documents with consistent structure.
Templates include predefined layouts, field configurations, and styling options.

**Returns**: `Object` - A properly formatted Template JoyDoc

**Example**

```javascript
import { getDefaultTemplate } from '@joyfill/components';

const template = getDefaultTemplate();
console.log('Template ID:', template._id);
console.log('Template name:', template.name);
```

---

### getDocumentFromTemplate(template)

Get a properly formatted Document JoyDoc from Template JoyDoc.

Creates a new document by cloning a template and assigning it a unique ID and identifier.
The template is deep cloned to remove all references to the original template object.
The resulting document maintains the template's structure (name, files, fields) while
being marked as a document type with references to the source template.

**Returns**: `Object` - A new document with unique _id, identifier, and template references

| Param | Type | Description |
| --- | --- | --- |
| `template` | `Object` | The template JoyDoc to create document from |

**Example**

```javascript
import { getDocumentFromTemplate } from '@joyfill/components';

const newDoc = getDocumentFromTemplate(template);
console.log('New document ID:', newDoc._id);
console.log('Document identifier:', newDoc.identifier);
console.log('Source template:', newDoc.template);
```

---

### applyLogic(items, fields, [fieldLookupKey])

Applies conditional logic to show/hide items based on field values.

**Logic object structure:**
- `action`: `'show'` or `'hide'`
  - `'show'`: if conditions are met, item becomes visible (`hidden = false`)
  - `'hide'`: if conditions are met, item becomes hidden (`hidden = true`)
- `eval`: `'and'` or `'or'`
  - `'and'`: all conditions must evaluate true
  - `'or'`: at least one condition must evaluate true
- `conditions`: array of rule objects with:
  - `field`: lookup key of the dependent field
  - `condition`: operator (see below)
  - `value`: value to compare against

**Supported condition operators:**
- `*=` → Filled (value exists or array non-empty)
- `null=` → Empty (null, empty string, or empty array)
- `=` → Equals (case-insensitive for strings; exact match for numbers)
- `!=` → Not equals
- `?=` → Contains substring (case-insensitive)
- `>` → Greater than (numbers only)
- `<` → Less than (numbers only)

**Returns**: `Object` - Updated items array with `hidden` property set based on logic evaluation

| Param | Type | Default | Description |
| --- | --- | --- | --- |
| `items` | `Array<object>` |  | Array of items (fields, pages, or groups) that may include a `logic` object |
| `fields` | `Array<object>` |  | Array of field objects used for logic evaluation |
| `[fieldLookupKey]` | `string` | `'_id'` | Property name used to match conditions to field identifiers |

**Example**

```javascript
import { applyLogic } from "@joyfill/components";

const fields = [
  { _id: "field_one", type: "text", value: "hello world" },
  { _id: "field_two", type: "number", value: 100 },
  { _id: "field_three", type: "multiSelect", value: ["option_one"] }
];

const items = [
  {
    _id: "conditional_one",
    hidden: true,
    logic: {
      action: "show",
      eval: "and",
      conditions: [
        { field: "field_one", condition: "?=", value: "hello" },
        { field: "field_two", condition: ">", value: 50 }
      ]
    }
  },
  {
    _id: "conditional_two",
    hidden: false,
    logic: {
      action: "hide",
      eval: "or",
      conditions: [
        { field: "field_three", condition: "=", value: "option_one" }
      ]
    }
  }
];

const result = applyLogic(items, fields);
// conditional_one.hidden = false (shown)
// conditional_two.hidden = true (hidden)
```

---

### generateObjectId()

Generates a unique object ID for JoyDoc elements.
Creates a unique identifier string that can be used for documents, pages, fields,
and other elements in the JoyDoc system. IDs are guaranteed to be unique.

**Returns**: `string` - A unique object ID string (24-character hex string)

**Example**

```javascript
import { generateObjectId } from '@joyfill/components';

const newId = generateObjectId();
console.log('New ID:', newId); // e.g., '507f1f77bcf86cd799439011'

// Use in document creation
const newDoc = {
  _id: generateObjectId(),
  title: 'My Document'
};
```

---

### validator(doc, [options])

Validates a JoyDoc document against field rules and constraints.
Performs comprehensive validation of a JoyDoc document including field validation rules,
required fields, data types, and business logic constraints.

**Returns**: `Object` - Validation result with status and field validations

| Param | Type | Description |
| --- | --- | --- |
| `doc` | `Object` | The JoyDoc document to validate |
| `[options]` | `Object` | Validation options |
| `[options.view]` | `string` | View type for validation ('desktop', 'mobile', 'tablet') |

**Example**

```javascript
import { validator } from '@joyfill/components';

const result = validator(doc, { view: 'desktop' });
if (result.status === 'valid') {
  console.log('Document is valid');
} else {
  console.log('Validation errors:', result.errors);
  result.fieldValidations.forEach(validation => {
    if (!validation.valid) {
      console.log(`Field ${validation.fieldId}: ${validation.message}`);
    }
  });
}
```

---

### validateSchema(doc)

Validates a JoyDoc document against the schema definition.
Performs schema validation to ensure the document structure conforms to the JoyDoc schema.
Checks for required properties, data types, and structural integrity.

**Returns**: `Object | undefined` - Returns an error object if validation fails, otherwise undefined

If an error object is returned, it contains:
- `error.code` - Error code (e.g., 'ERROR_SCHEMA_VALIDATION')
- `error.message` - Human-readable error message
- `error.errors` - Array of detailed validation errors
- `error.details` - Additional error details including schema version

| Param | Type | Description |
| --- | --- | --- |
| `doc` | `Object` | The JoyDoc document to validate against schema |

**Example**

```javascript
import { validateSchema } from '@joyfill/components';

const schemaError = validateSchema(doc);
if (schemaError) {
  console.error('Schema validation failed:', schemaError.message);
  console.error('Error code:', schemaError.code);
  console.error('Detailed errors:', schemaError.errors);
} else {
  console.log('Document schema is valid');
}
```

---

## Configuration

### fieldOptions

Default field options configuration for the draggable field list.
Contains predefined field types, icons, and configurations that can be used
in the JoyDoc component to provide a standard set of available field types.

**Type**: `Array`

**Properties:**

| Name | Type | Description |
| --- | --- | --- |
| `title` | `string` | Display title for the field type |
| `type` | `string` | Field type identifier (e.g., 'text', 'number', 'date', 'fieldGroup') |
| `icon` | `string` | Icon name for the field type |
| `iconType` | `string` | Icon type: 'custom' for SVG, 'url' for image URL |
| `displayType` | `string` | Display type (e.g., 'original', 'check') |
| `identifier` | `string` | Custom identifier for the field |
| `config` | `Object` | Default configuration for the field type |
| `fields` | `Array` | Nested fields for fieldGroup type |
| `open` | `boolean` | Whether fieldGroup is open by default |

**Example**

```javascript
import { fieldOptions } from '@joyfill/components';

// Use default field options in JoyDoc
<JoyDoc fieldOptions={fieldOptions} />

// Custom field options with pre-configured styles
const customFieldOptions = [
  {
    title: 'Customer Name',
    type: 'text',
    identifier: 'custom_customer_name',
    fontColor: '#0096FF',
    fontWeight: 'bold'
  },
  {
    type: 'fieldGroup',
    title: 'Custom Fields',
    open: false,
    fields: [
      { title: 'Grouped Text', type: 'text' }
    ]
  }
];

<JoyDoc fieldOptions={customFieldOptions} />
```

---

### fieldColumnTypes

Field table column types configuration.
Defines available column types for table fields in JoyDoc forms.
These constants can be used when creating or configuring table columns
to ensure consistency and proper type handling.

**Type**: `Object`

**Properties:**

| Name | Type | Description |
| --- | --- | --- |
| `text` | `string` | Text column type identifier |
| `dropdown` | `string` | Dropdown column type identifier |
| `image` | `string` | Image column type identifier |
| `number` | `string` | Number column type identifier |
| `multiSelect` | `string` | Multi-select column type identifier |
| `date` | `string` | Date column type identifier |
| `block` | `string` | Block column type identifier |
| `barcode` | `string` | Barcode column type identifier |
| `signature` | `string` | Signature column type identifier |

**Example**

```javascript
import { fieldColumnTypes } from '@joyfill/components';

// Use in table column configuration
const tableColumn = {
  type: fieldColumnTypes.text,
  label: 'Name',
  required: true
};

// Check available types
console.log('Available column types:', Object.values(fieldColumnTypes));
```
